= DarkRadiant User Guide
:toc: left
:imagesdir: img
:icons:
:iconsdir: img

== Introduction

DarkRadiant is a level editor for Doom 3 and The Dark Mod, developed by The Dark
Mod team. It may also be used for editing levels for similar *id Software* games
such as Quake 4.

This User Guide describes the features and functionality of DarkRadiant, however
it is not intended as a guide to mapping techniques. Level design is a complex
topic, and is covered by various other learning resources, some of which are
listed below.

http://wiki.thedarkmod.com/index.php?title=Main_Page[The Dark Mod Wiki]:: The
starting point for most Dark Mod documentation and tutorials, including
gameplay, configuration and editing.

https://modwiki.xnet.fi[ModWiki]:: Online wiki covering editing topics for
vanilla Doom 3 and similar engines.

http://forums.thedarkmod.com[The Dark Mod forums]:: Online community for
discussion of the Dark Mod, including various ad-hoc mapping tutorial threads
posted by individual users.

=== Editing workflow

image::DarkRadiantWorkflow.png[align="center"]

The level editing process starts off with basic assets: models, textures,
sounds, entity definitions, skins, animations and so on. Many of these assets
will be packaged with a particular game installation, but a level designer may
also choose to create custom assets for a specific mission. These assets are
installed into a directory tree which is accessible both by DarkRadiant (for
editing) and the game engine itself (for playing the mission).

Once assets have been arranged in DarkRadiant according to the wishes of the
level designer, a `.map` file is saved to disk. This is a text file in a format
understood by the game engine, and includes both level geometry and references
to the assets used in the map. Since the `.map` file is simply text, and does
not actually embed the binary asset data, it tends to be fairly small.

The game engine includes functionality to _compile_ the `.map` file into a
`.proc` file containing low-level vertex geometry derived from the brushes and
patches within the `.map` file. The game engine can then render the mission in
realtime, making use of the same assets that were accessed by DarkRadiant during
editing.

DarkRadiant also maintains its own separate file containing various editing
information, such as object layers used within a map. This `.darkradiant` file
is never used by the game engine, and is non-critical -- a `.map` file with no
accompanying `.darkradiant` file can still be edited with DarkRadiant, although
certain DarkRadiant-specific state may be lost.

== Initial configuration

=== Choosing a game type

When running DarkRadiant for the first time, the *Game Setup* dialog will be
shown. This is where you configure the path to the game installation from which
DarkRadiant will load assets, such as textures, models and entity definitions.

image::GameSetupDialog.png[align="center"]

The *Game Setup* dialog allows configuration of the following options:

*Game Type*:: DarkRadiant ships with support for several different game engines,
 each of which is contained within a `.game` file. For editing Dark Mod
 missions, the default choice of `The Dark Mod 2.0 (Standalone)` is the one to
 use, but it is also possible to edit stock Doom 3 or Quake 4 missions.

*DarkMod Path* / *Engine Path*:: This is the path to the game installation on
 the system. The label text will change depending on whether the selected game
 is `The Dark Mod` or another engine.

*Mission*:: Optional path to a subdirectory containing assets specific to a
 particular mission which is being worked on. For game types other than `The
 Dark Mod`, this will be displayed as *Mod (fs_game)*, and should be set to the
 path of a subdirectory containing a particular game mod, if one is being used.

*Mod Base (fs_game_base)*:: This field only appears for non-DarkMod game types.
 It allows a two-level mod structure, where the *Mod Base* can point to a major
 game mod, possibly downloaded from elsewhere, while *Mod* can be set to point
 to an entirely local "sub-mod" which contains local changes and overrides.
 Before the release of Dark Mod standalone, this field would have been set to
 `darkmod` while the *Mod* field would have been set to the local mission,
 however this is no longer necessary when `The Dark Mod 2.0 (Standalone)` is
 being used.

Once the game paths are set up, click the *Save* button to proceed to the main
DarkRadiant interface.

NOTE: It is possible to *Cancel* the *Game Setup* dialog and proceed to the main
window without configuring a game installation, in which case DarkRadiant will
show a warning and ask if you wish to proceed. If you do, DarkRadiant will run
but there will be no available textures, models, entities or other game assets.

=== Interface layout

DarkRadiant ships with a number of different user interface layouts, which
control the position, visibility and window type of the major interface
elements. The current layout can be changed from the `View -> Window Layout`
menu, and will require DarkRadiant to be restarted.

There is currently no support for custom layouts, however all of the provided
layouts allow window sizes and splitter positions to be changed, and the changes
will persist through multiple editing sessions.

*Embedded*:: A large 2D window is shown on the right, while the left-hand side
 is divided vertically into the 3D camera window and a tab widget containing the
 main editing panels. There are no floating subwindows in this layout.

*Regular*:: A legacy GtkRadiant layout which places the 2D window on the left,
 the 3D camera view on the top right, and a 2D scrolling textures panel on the
 bottom right. Other tabs in the editing panel are shown in a floating window.

*RegularLeft*:: The same as *Regular* except the full-height 2D window is on the
 right and the 3D window and texture panels are on the left.

*Floating*:: The 2D window, 3D window and editing tab widget are all shown in
 separate floating windows which always appear above the main DarkRadiant
 window. The main window itself is empty apart from the toolbars and status bar.
 This is the most flexible layout, since each subwindow can be sized or
 positioned as desired, but the multiple subwindows may be cumbersome to manage.

*SplitPane*:: Three separate 2D windows, showing each of the major axes, are
 shown alongside the 3D camera view in a 2x2 layout similar to traditional 3D
 modelling applications. The editing tab widget is in a floating window.

== Basic editing

=== Navigating the 2D view

The game world is a three-dimensional vector space with a central origin,
rendered in the 2D editing window as a grid. The unit of measurement is an
arbitrary game unit which does not directly correspond to any real-world
measurement system -- in The Dark Mod, a typical human stands around 80 - 90
game units high, making a game unit about 2 cm.

Each 2D window shows which axes it is representing with an icon in the top-left
corner, as well as an identical icon at the `<0,0,0>` origin position, if
visible within the view.

image::2DViewMarkedUp.png[align="center"]

The 2D view also shows the current position of the camera (used for rendering
the separate 3D camera view window), and its view direction.

The following commands are available within the 2D view:

[options="autowidth"]
|===
|*Right-drag*|Scroll the view horizontally or vertically (relative to the
 window).
|*Mouse wheel*|Zoom the view
|*Shift-right-drag*|Zoom the view (alternative binding)
|*Ctrl-middle-click*|Move the camera directly to the clicked position
|*Middle-click*|Rotate the camera to look directly at the clicked point
|*Ctrl-TAB*|Change view axis (XY, XZ, YZ)
|*Ctrl-Shift-TAB*|Center 2D view on current camera position
|===

=== Adjusting the grid

The grid shown in the 2D view is used to snap the position and size of brushes
and patches, as well as the centerpoints of entities. The size of the grid can
be configured, in powers of 2, from 0.125 up to 256, using the *1-9* keys on the
main keyboard (not the numeric keypad), or the equivalent options in the *Grid*
menu.

The *0 key* on the main keyboard can be used to toggle the display of the grid.
Note that objects will still be snapped to the grid even if the grid is not
visible; this is purely a visual toggle.

IMPORTANT: Level geometry built from brushes and patches should *always* be
snapped to the grid to avoid problems such as rendering glitches and map leaks.
Static meshes and animated AI can be positioned more freely, however grid
snapping is a useful tool for ensuring that models are appropriately aligned
with the level geometry.
